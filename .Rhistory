baseball <- baseball |>
mutate(Team = as.factor(Team)) |>
mutate(Lg = as.factor(Lg))
#Cleaning up Variable Names and Columns
baseball <- baseball |>
dplyr::select(-Rk) |>
mutate(Division = case_when(
Team %in% c("NYY", "BOS", "TOR", "BAL", "TBR") ~ "AL East",
Team %in% c("CHW", "CLE", "DET", "KCR", "MIN") ~ "AL Central",
Team %in% c("HOU", "LAA", "OAK", "SEA", "TEX") ~ "AL West",
Team %in% c("ATL", "MIA", "NYM", "PHI", "WSN") ~ "NL East",
Team %in% c("CHC", "CIN", "MIL", "PIT", "STL") ~ "NL Central",
Team %in% c("LAD", "SFG", "SDP", "COL", "ARI") ~ "NL West",)) |>
filter(!is.na(Division)) |>
clean_names() |>
rename(league = lg, games = g, runs = r, hits = h, doubles = x2b,
triples = x3b, steals = sb, ops_adj = ops_2)
#Making Dataset with only Numeric Variables
baseball_numeric <- baseball |>
dplyr::select(where(is.numeric))
#Looking at a Summary of the Data
summary(baseball)
#Making a correlation plot
corrplot(cor(baseball_numeric))
# removing non predictor variables
baseball <- baseball |>
select(-player, -league, -team)
# removing non predictor variables
baseball <- baseball |>
dplyr::select(-player, -league, -team)
# making division a factor
baseball$division <- as.factor(baseball$division)
# creating dummy variables with NL West as baseline (Shohei Ohtani's Division)
baseball <- baseball |>
mutate(
division_AL_East = ifelse(division == "AL East", 1, 0),
division_AL_West = ifelse(division == "AL West", 1, 0),
division_AL_Central = ifelse(division == "AL Central", 1, 0),
division_NL_Central = ifelse(division == "NL Central", 1, 0),
division_NL_East = ifelse(division == "NL East", 1, 0)
) %>%
select(-division)
# removing non predictor variables
baseball <- baseball |>
dplyr::select(-player, -league, -team)
seahome <- read.csv("Splits Leaderboard Data SEA Away.csv")
seahome <- read.csv("Splits Leaderboard Data SEA Away.csv")
seaaway <- read.csv("Splits Leaderboard Data SEA Home.csv")
View(seahome)
seaaway <- read.csv("Splits Leaderboard Data SEA Away.csv") |>
seaaway <- read.csv("Splits Leaderboard Data SEA Away.csv")
seahome <- read.csv("Splits Leaderboard Data SEA Home.csv")
View(seaaway)
View(seahome)
seaaway <- read_table("SEA Away.xlsx")
seaaway <- read.table("SEA Away.xlsx")
seaaway <- read.table("SEA Away.xlsx")
seaaway <- read.table("SEA Away.xlsx")
View(seaaway)
library(readxl)
library(readxl)
library(tidyverse)
seaaway <- read_excel("SEA Away.xlsx")
View(seaaway)
seahome <- read_excel("SEA Home.xlsx")
View(seahome)
seaaway <- read_excel("SEA Away.xlsx")
seaaway <- paste(season, name)
seaaway <- read_excel("SEA Away.xlsx")
seaaway <- paste(seaaway$season, seaaway$name)
seaaway <- read_excel("SEA Away.xlsx")
seaaway$combined <- paste(seaaway$season, seaaway$name)
seaaway <- read_excel("SEA Away.xlsx") |>
select(Season, Name, AVG)
seahome <- read_excel("SEA Home.xlsx") |>
select(Season, Name, AVG)
seaaway <- read_excel("SEA Away.xlsx") |>
select(Season, Name, AVG, playerID)
seaaway <- read_excel("SEA Away.xlsx") |>
select(Season, Name, AVG, playerid)
seaaway <- read_excel("SEA Away.xlsx") |>
select(Season, Name, AVG)
seaaway <- read_excel("SEA Away.xlsx") |>
select(Season, Name, AVG) |>
mutate(combined = str_c(Season, Name))
seaaway <- read_excel("SEA Away.xlsx") |>
select(Season, Name, AVG) |>
mutate(Player = str_c(Season, Name))
seaaway <- read_excel("SEA Away.xlsx") |>
mutate(Player = str_c(Season, Name)) |>
select(Player, AVG)
seaaway <- read_excel("SEA Away.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG)
seahome <- read_excel("SEA Home.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG)
library(dplyr)
homevsaway <- seaaway |>
left_join(seahome, by = "Player")
View(homevsaway)
seahome <- read_excel("SEA Home.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG) |>
mutate("AVG" = "AVGHome")
seahome <- read_excel("SEA Home.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG)
seahome <- read_excel("SEA Home.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG) |>
rename(AVGHome = AVG)
seaaway <- read_excel("SEA Away.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG) |>
rename(AVGAway = AVG)
homevsaway <- seaaway |>
left_join(seahome, by = "Player")
homevsaway <- seaaway |>
left_join(seahome, by = "Player") |>
drop_na()
ggplot(homevsaway, aes(x = AVGHome, y = AVGAway)) +
geom_point()
ggplot(homevsaway, aes(x = AVGHome, y = AVGAway)) +
geom_point(color = 'navy')
t.test(AVGHome ~ AVGAway, data = homevsaway)
t.test(AVGHome ~ AVGAway, data = homevsaway, paired = TRUE)
t.test(homevsaway$AVGHome, homevsaway$AVGAway, paired = TRUE)
homevsaway %>%
pivot_longer(cols = c(AVGHome, AVGAway), names_to = "Location", values_to = "AVG"))
homevsaway %>%
pivot_longer(cols = c(AVGHome, AVGAway), names_to = "Location", values_to = "AVG")
homevsaway |>
pivot_longer(cols = c(AVGHome, AVGAway), names_to = "Location", values_to = "AVG")
homevsaway <- homevsaway |>
pivot_longer(cols = c(AVGHome, AVGAway), names_to = "Location", values_to = "AVG")
library(readxl)
library(tidyverse)
library(dplyr)
seaaway <- read_excel("SEA Away.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG) |>
rename(AVGAway = AVG)
seahome <- read_excel("SEA Home.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG) |>
rename(AVGHome = AVG)
homevsaway <- seaaway |>
left_join(seahome, by = "Player") |>
drop_na()
t.test(homevsaway$AVGHome, homevsaway$AVGAway, paired = TRUE
t.test(homevsaway$AVGHome, homevsaway$AVGAway, paired = TRUE)
homevsaway |>
pivot_longer(cols = c(AVGHome, AVGAway), names_to = "Location", values_to = "AVG")
homevsaway |>
pivot_longer(cols = c(AVGHome, AVGAway), names_to = "Location", values_to = "AVG") |>
ggplot(aes(x = Location, y = AVG)) +
geom_violin(fill = "skyblue", alpha = 0.5) +
geom_boxplot(width = 0.2) +
theme_minimal()
homevsaway |>
pivot_longer(cols = c(AVGHome, AVGAway), names_to = "Location", values_to = "AVG") |>
ggplot(aes(x = Location, y = AVG, group = Player)) +
geom_line(alpha = 0.5) +
geom_point() +
theme_minimal() +
labs(title = "Player AVG: Home vs Away")
wilcox.test(homevsaway$AVGHome, homevsaway$AVGAway, paired = TRUE)
seaaway <- read_excel("SEA Away.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG)
rename(AVGAway = AVG)
library(readxl)
library(tidyverse)
library(dplyr)
seaaway <- read_excel("SEA Away.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG)
rename(AVGAway = AVG)
seaaway <- read_excel("SEA Away.xlsx")}  |>
seaaway <- read_excel("SEA Away.xlsx")  |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG) |>
rename(AVGAway = AVG)
library(readxl)
library(tidyverse)
library(dplyr)
seaaway <- read_excel("SEA Away.xlsx")  |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG) |>
rename(AVGAway = AVG)
seahome <- read_excel("SEA Home.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG) |>
rename(AVGHome = AVG)
homevsaway <- seaaway |>
left_join(seahome, by = "Player") |>
drop_na()
t.test(homevsaway$AVGHome, homevsaway$AVGAway, paired = TRUE)
homevsaway |>
pivot_longer(cols = c(AVGHome, AVGAway), names_to = "Location", values_to = "AVG") |>
ggplot(aes(x = Location, y = AVG, group = Player)) +
geom_line(alpha = 0.5) +
geom_point() +
theme_minimal() +
labs(title = "Player AVG: Home vs Away")
wilcox.test(homevsaway$AVGHome, homevsaway$AVGAway, paired = TRUE)
library(readxl)
library(tidyverse)
library(dplyr)
seaaway <- read_excel("SEA Away.xlsx")  |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG) |>
rename(AVGAway = AVG)
seahome <- read_excel("SEA Home.xlsx") |>
mutate(Player = str_c(Season, Name, sep = ' ')) |>
select(Player, AVG) |>
rename(AVGHome = AVG)
homevsaway <- seaaway |>
left_join(seahome, by = "Player") |>
drop_na()
t.test(homevsaway$AVGHome, homevsaway$AVGAway, paired = TRUE)
homevsaway |>
pivot_longer(cols = c(AVGHome, AVGAway), names_to = "Location", values_to = "AVG") |>
ggplot(aes(x = Location, y = AVG, group = Player)) +
geom_line(alpha = 0.5) +
geom_point() +
theme_minimal() +
labs(title = "Player AVG: Home vs Away")
wilcox.test(homevsaway$AVGHome, homevsaway$AVGAway, paired = TRUE)
#Downloading Libraries
library(bestglm)       #Finds the Best Model using In Model Metrics
library(car)           #Helps us to measure VIF
library(corrplot)      #Makes the correlation matrix
library(dplyr)         #Brings in essential functions
library(GGally)        #Makes the scatterplot matrix
library(ggfortify)     #Runs the Residuals vs Fitted Plot, Q-Q Plot, Residuals vs Leverage Plot
library(glmnet)        #Runs LASSO and Ridge Regression
library(janitor)       #Cleaning up and organizing data
library(patchwork)     #Puts together multiple plots into one output
library(tidyverse)     #Brings in all core packages
#Bringing in data
baseball <- read.csv("MLB_Player_Batting_2024.csv", header = T)
baseball <- baseball[-1, ]
#Changing Categorical Variables to Factors
baseball <- baseball |>
mutate(Team = as.factor(Team)) |>
mutate(Lg = as.factor(Lg))
#Cleaning up Variable Names and Columns
baseball <- baseball |>
select(-Rk) |>
mutate(Division = case_when(
Team %in% c("NYY", "BOS", "TOR", "BAL", "TBR") ~ "AL East",
Team %in% c("CHW", "CLE", "DET", "KCR", "MIN") ~ "AL Central",
Team %in% c("HOU", "LAA", "OAK", "SEA", "TEX") ~ "AL West",
Team %in% c("ATL", "MIA", "NYM", "PHI", "WSN") ~ "NL East",
Team %in% c("CHC", "CIN", "MIL", "PIT", "STL") ~ "NL Central",
Team %in% c("LAD", "SFG", "SDP", "COL", "ARI") ~ "NL West",)) |>
filter(!is.na(Division)) |>
clean_names() |>
rename(league = lg, games = g, runs = r, hits = h, doubles = x2b,
triples = x3b, steals = sb, ops_adj = ops_2)
#Making Dataset with only Numeric Variables
baseball_numeric <- baseball |>
select(where(is.numeric))
#Looking at a Summary of the Data
summary(baseball)
#Making a correlation plot
corrplot(cor(baseball_numeric))
baseball_lm <- lm(hr ~ . - player - team - league, data = baseball)
summary(baseball_lm)
# removing non predictor variables
baseball <- baseball |>
select(-player, -league, -team)
# making division a factor
baseball$division <- as.factor(baseball$division)
# creating dummy variables with NL West as baseline (Shohei Ohtani's Division)
baseball <- baseball |>
mutate(
division_AL_East = ifelse(division == "AL East", 1, 0),
division_AL_West = ifelse(division == "AL West", 1, 0),
division_AL_Central = ifelse(division == "AL Central", 1, 0),
division_NL_Central = ifelse(division == "NL Central", 1, 0),
division_NL_East = ifelse(division == "NL East", 1, 0)
) %>%
select(-division)
# moving hr to the end of the dataset
baseball <- baseball |>
select(-hr, everything(), hr)
# running AIC for hr
best_hr_aic <- bestglm(baseball, IC = "AIC")
# summary of results
summary(best_hr_aic$BestModel)
corbaseball <- cor(baseball)
diag(corbaseball) <- NA
high_correlation <- which(abs(corbaseball) > 0.8, arr.ind = TRUE)
if (nrow(high_correlation) > 0) {
for (i in 1:nrow(high_correlation)) {
var1 <- rownames(corbaseball)[high_correlation[i, 1]]
var2 <- colnames(corbaseball)[high_correlation[i, 2]]
corr_value <- corbaseball[high_correlation[i, 1], high_correlation[i, 2]]
cat(sprintf("%s and %s: %.2f\n", var1, var2, corr_value))
}
} else {
cat("No correlations greater than 0.8 found.\n")
}
View(baseball)
corbaseball <- cor(baseball)
diag(corbaseball) <- NA
high_correlation <- which(abs(corbaseball) > 0.95, arr.ind = TRUE)
if (nrow(high_correlation) > 0) {
for (i in 1:nrow(high_correlation)) {
var1 <- rownames(corbaseball)[high_correlation[i, 1]]
var2 <- colnames(corbaseball)[high_correlation[i, 2]]
corr_value <- corbaseball[high_correlation[i, 1], high_correlation[i, 2]]
cat(sprintf("%s and %s: %.2f\n", var1, var2, corr_value))
}
} else {
cat("No correlations greater than 0.8 found.\n")
}
corbaseball <- cor(baseball)
diag(corbaseball) <- NA
high_correlation <- which(abs(corbaseball) > 0.8, arr.ind = TRUE)
if (nrow(high_correlation) > 0) {
for (i in 1:nrow(high_correlation)) {
var1 <- rownames(corbaseball)[high_correlation[i, 1]]
var2 <- colnames(corbaseball)[high_correlation[i, 2]]
corr_value <- corbaseball[high_correlation[i, 1], high_correlation[i, 2]]
cat(sprintf("%s and %s: %.2f\n", var1, var2, corr_value))
}
} else {
cat("No correlations greater than 0.8 found.\n")
}
baseball <- baseball |>
select(-ab, -hits, -ops, -slg, -r_oba, -tb, -games, -ops_adj, -obp, -runs, -doubles)
# removing non predictor variables
baseball <- baseball |>
select(-player, -league, -team)
# removing non predictor variables
# making division a factor
baseball$division <- as.factor(baseball$division)
# running AIC for hr
best_hr_aic <- bestglm(baseball, IC = "AIC")
# summary of results
summary(best_hr_aic$BestModel)
corrplot(baseball)
corrplot(cor(baseball)
load(tidyverse)
library(tidyverse)
library(tidymodels)
install.packages("tidymodels")
library(tidymodels)
cat('
\\begin{table}[h!]
\\centering
\\begin{tabular}{l|cc}
\\hline
& \\multicolumn{2}{c}{\\textbf{Progesterone}} \\\\
\\textbf{Estrogen} & \\textbf{Positive} & \\textbf{Negative} \\\\
\\hline
Positive & 13/28 & 4/28 \\\\
Negative & 2/28  & 9/28 \\\\
\\hline
\\end{tabular}
\\caption{ }
\\end{table}
')
library(tidyverse)
library(tidymodels)
bikeTrain <- vroom("train.csv")
library(vroom)
bikeTrain <- vroom("train.csv")
setwd("~/GitHub/STAT 348/KaggleBikeShare")
bikeTrain <- vroom("train.csv")
bikeTest <- vroom("test.csv")
bikeTrain_clean <- bikeTrain |>
select(-casual, -registered) |>
mutate(count = log(count))
bike_recipe <- recipe(count ~ ., data = bikeTrain_clean) |>
step_mutate(weather = ifelse(weather == 4, 3, weather)) |>
step_mutate(weather = factor(weather)) |>
step_time(datetime, features = "hour") |>
step_mutate(season = factor(season)) |>
step_zv(all_predictors()) |>
step_dummy(all_nominal_predictors()) |>
step_normalize(all_numeric_predictors())
bike_recipe <- recipe(count ~ ., data = bikeTrain_clean) |>
step_mutate(weather = ifelse(weather == 4, 3, weather)) |>
step_mutate(weather = factor(weather)) |>
step_time(datetime, features = "hour") |>
step_mutate(season = factor(season)) |>
step_zv(all_predictors()) |>
step_dummy(all_nominal_predictors()) |>
step_normalize(all_numeric_predictors())
install.packages("tidymodels")
install.packages("tidymodels")
library(tidyverse)
library(tidymodels)
library(vroom)
bikeTrain <- vroom("train.csv")
bikeTest <- vroom("test.csv")
bikeTrain_clean <- bikeTrain |>
select(-casual, -registered) |>
mutate(count = log(count))
bike_recipe <- recipe(count ~ ., data = bikeTrain_clean) |>
step_mutate(weather = ifelse(weather == 4, 3, weather)) |>
step_mutate(weather = factor(weather)) |>
step_time(datetime, features = "hour") |>
step_mutate(season = factor(season)) |>
step_zv(all_predictors()) |>
step_dummy(all_nominal_predictors()) |>
step_normalize(all_numeric_predictors())
library(recipes)
bikeTrain <- vroom("train.csv")
bikeTest <- vroom("test.csv")
bikeTrain_clean <- bikeTrain |>
select(-casual, -registered) |>
mutate(count = log(count))
bike_recipe <- recipe(count ~ ., data = bikeTrain_clean) |>
step_mutate(weather = ifelse(weather == 4, 3, weather)) |>
step_mutate(weather = factor(weather)) |>
step_time(datetime, features = "hour") |>
step_mutate(season = factor(season)) |>
step_zv(all_predictors()) |>
step_dummy(all_nominal_predictors()) |>
step_normalize(all_numeric_predictors())
bike_prep <- prep(bike_recipe)
bike_baked <- bake(bike_prep, new_data = bikeTrain_clean)
print(head(bike_baked, 5))
#Penalized Regression Model
preg_model <- linear_reg(penalty = 1, mixture = 0.5) |>
set_engine("glmnet")
R.version.string
library(tidyverse)
setwd("~/GitHub/STAT 348/KaggleBikeShare")
library(tidyverse)
library(tidymodels)
library(vroom)
bikeTrain <- vroom("train.csv")
bikeTest <- vroom("test.csv")
bikeTrain_clean <- bikeTrain |>
select(-casual, -registered) |>
mutate(count = log(count))
bike_recipe <- recipe(count ~ ., data = bikeTrain_clean) |>
step_mutate(weather = ifelse(weather == 4, 3, weather)) |>
step_mutate(weather = factor(weather)) |>
step_time(datetime, features = "hour") |>
step_mutate(season = factor(season)) |>
step_zv(all_predictors()) |>
step_dummy(all_nominal_predictors()) |>
step_normalize(all_numeric_predictors())
library(recipes)
bike_recipe <- recipe(count ~ ., data = bikeTrain_clean) |>
step_mutate(weather = ifelse(weather == 4, 3, weather)) |>
step_mutate(weather = factor(weather)) |>
step_time(datetime, features = "hour") |>
step_mutate(season = factor(season)) |>
step_zv(all_predictors()) |>
step_dummy(all_nominal_predictors()) |>
step_normalize(all_numeric_predictors())
bike_prep <- prep(bike_recipe)
bike_baked <- bake(bike_prep, new_data = bikeTrain_clean)
library(parsnip)
#Penalized Regression Model
preg_model <- linear_reg(penalty = 1, mixture = 0.5) |>
set_engine("glmnet")
preg_wf <- workflow() |>
add_recipe(bike_recipe) |>
add_model(preg_model) |>
fit(data = bikeTrain)
library(workflows)
#Penalized Regression Model
preg_model <- linear_reg(penalty = 1, mixture = 0.5) |>
set_engine("glmnet")
preg_wf <- workflow() |>
add_recipe(bike_recipe) |>
add_model(preg_model) |>
fit(data = bikeTrain)
#Penalized Regression Model
preg_model <- linear_reg(penalty = 1, mixture = 0.5) |>
set_engine("glmnet")
preg_wf <- workflow() |>
add_recipe(bike_recipe) |>
add_model(preg_model) |>
fit(data = bikeTrain_clean)
predict(preg_wf, new_data = bikeTest)
#Linear Regression Model
lin_model <- linear_reg() |>
set_engine('lm') |>
set_mode('regression')
bike_workflow <- workflow() |>
add_recipe(bike_recipe) |>
add_model(lin_model) |>
fit(data = bikeTrain_clean)
lin_preds <- predict(bike_workflow, new_data = bikeTest)
lin_preds <- lin_preds |>
mutate(.pred = exp(.pred))
#Penalized Regression Model
preg_model <- linear_reg(penalty = 1, mixture = 0.5) |>
set_engine("glmnet")
preg_wf <- workflow() |>
add_recipe(bike_recipe) |>
add_model(preg_model) |>
fit(data = bikeTrain_clean)
#Penalized Regression Model
preg_model <- linear_reg(penalty = 0.2, mixture = 0.5) |>
set_engine("glmnet")
preg_wf <- workflow() |>
add_recipe(bike_recipe) |>
add_model(preg_model) |>
fit(data = bikeTrain_clean)
rlang::last_trace()
